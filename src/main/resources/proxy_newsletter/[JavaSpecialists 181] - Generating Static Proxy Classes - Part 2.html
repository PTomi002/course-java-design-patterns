








<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">



<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">






    
    
    

<!DOCTYPE html>
<html><head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-179954577-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-179954577-1');
    </script>
    <!-- Deadline Funnel -->
    <script type="text/javascript" data-cfasync="false">function SendUrlToDeadlineFunnel(e){var r,t,c,a,h,n,o,A,i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,l=0,s="",u=[];if(!e)return e;do r=e.charCodeAt(d++),t=e.charCodeAt(d++),c=e.charCodeAt(d++),A=r<<16|t<<8|c,a=A>>18&63,h=A>>12&63,n=A>>6&63,o=63&A,u[l++]=i.charAt(a)+i.charAt(h)+i.charAt(n)+i.charAt(o);while(d<e.length);s=u.join("");var C=e.length%3;var decoded = (C?s.slice(0,C-3):s)+"===".slice(C||3);decoded = decoded.replace("+", "-");decoded = decoded.replace("/", "_");return decoded;} var dfUrl = SendUrlToDeadlineFunnel(location.href); var dfParentUrlValue;try {dfParentUrlValue = window.parent.location.href;} catch(err) {if(err.name === "SecurityError") {dfParentUrlValue = document.referrer;}}var dfParentUrl = (parent !== window) ? ("/" + SendUrlToDeadlineFunnel(dfParentUrlValue)) : "";(function() {var s = document.createElement("script");s.type = "text/javascript";s.async = true;s.setAttribute("data-scriptid", "dfunifiedcode");s.src ="https://a.deadlinefunnel.com/unified/reactunified.bundle.js?userIdHash=eyJpdiI6IkhwbnVnUjB2eU9ZVzJBb2tTOWwwR1E9PSIsInZhbHVlIjoibjNKeEVGdlNVY1ZwRUJCNVZPXC9BeXc9PSIsIm1hYyI6IjJlNzY1OGZmOWY1NzA1MDY5MDEyODNiNjhiMGQ3N2VjZGRhZDE5NmU4ZDljOTY0M2RiYzVmZTdmOGFlNjVkM2YifQ==&pageFromUrl="+dfUrl+"&parentPageFromUrl="+dfParentUrl;var s2 = document.getElementsByTagName("script")[0];s2.parentNode.insertBefore(s, s2);})();</script><!-- End Deadline Funnel -->
    <title>[JavaSpecialists 181] - Generating Static Proxy Classes - Part 2</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    
    <link rel="canonical" href="https://www.javaspecialists.eu/archive/Issue181-Generating-Static-Proxy-Classes---Part-2.html" />
    

    <meta name="description" content="In this newsletter, we show how the Generator described in our previous issue can be used to create virtual proxy classes statically, that is, by generating code instead of using dynamic proxies." />
    <meta name="keywords" content="java,core java course,core java courses,concurrency,threading, fork-join framework,java performance tuning,java performance,advanced java,dynamic proxy,java threading,java concurrency,java.util.concurrent,java.util.concurrency" />
    <link href="https://www.javaspecialists.eu/archive/tjsn.rss" rel="alternate" type="application/rss+xml" title="rss"/>
    <link rel="icon" href="/favicon.ico" type="image/x-icon"/>
    <link rel="shortcut icon" href="/favicon.ico"/>
    <script type="text/javascript" src="/skin/skin4/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="/skin/skin4/js/kickstart.js"></script>                                  <!-- KICKSTART -->
    <link rel="stylesheet" type="text/css" href="/skin/skin4/css/kickstart.css" media="all" />                  <!-- KICKSTART -->
    <link rel="stylesheet" type="text/css" href="/skin/skin4/style.css" media="all" />                          <!-- CUSTOM STYLES -->
    
</head><body>

<div class="grid">
    <!-- ===================================== END HEADER ===================================== -->

    <div class="col_12" style="margin-top:20px;">
        <div><h4 class="logo"><a href="/">Javaspecialists</a></h4></div>
        <div>Running on Java 17+35-2724 (Preview)
        <div class="strapline">Home of <span>The</span> JavaSpecialists' Newsletter</div>
    </div>

    <!---------- MAIN NAVIGATION MENU ---------->

<div class="col_12" style="margin-top:20px;">
    <ul class="menu">
        <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
        <li><a href="/archive/"><i class="fa fa-align-left"></i> The Newsletter</a>
            <ul>
                <li><a href="/archive/">All Issues</a></li>
                <li><a href="/archive/subscribe/">Subscribe</a></li>
                <li><a href="/archive/countries/">Countries</a></li>
            </ul>
        </li>
        <li><a href="https://javaspecialists.teachable.com">Self-Study Courses</a>
            <ul>
                <li><a href="/courses/juppies2">Juppies 2 - Beginner's Java Course (Free)</a>
                <li><a href="https://javaspecialists.teachable.com/p/data-structures">Data Structures in Java 9 ($250)</a>
                <li><a href="https://javaspecialists.teachable.com/p/dpc5">Java Design Patterns Course ($525)</a>
                <li><a href="https://javaspecialists.teachable.com/p/concurrency-in-practice-bundle">Java Concurrency in Practice Bundle ($900)</a>
                <li><a href="https://javaspecialists.teachable.com/p/superpack22">Java Specialists Superpack '22 ($1870)</a>
                <li><a href="https://javaspecialists.teachable.com/courses/">More...</a>
            </ul>
        </li>
        <li><a href="/courses/">Classroom And Remote Courses</a>
            <ul>
                <li><a href="/courses/">Training Overview</a></li>
<li><a href="/courses/datastructures/">1. Data Structures</a></li>
<li><a href="/courses/intellijwizardry/">2. IntelliJ Wizardry</a></li>
<li><a href="/courses/refactorj8/">3. Refactoring to Streams</a></li>
<li><a href="/courses/dpc/">4. Design Patterns</a></li>
<li><a href="/courses/xj-adv/">5. Advanced Topics</a></li>
<li><a href="/courses/xj-conc/">6. Concurrency Performance</a></li>
<li><a href="/courses/concurrency/">7. Concurrency Specialist</a></li>
<li><a href="/courses/#inhouse">In-house</a></li>
<li><a href="/courses/self-study/">Self-study</a></li>

            </ul>
        </li>


        <li><a href="/slack/">Slack</a>
        </li>
        <li><a href="/about/">About Us</a>
            <ul>
                <li><a href="/about/">The Company</a>
                <li><a href="/about/heinz/">About Heinz</a>
                <li><a href="/about/java-trainers/">Java Trainers</a></li>
                <li><a href="/about/champion/">Java Champions</a></li>
                <li><a href="/about/testimonials/">Course Feedback</a></li>
                <li><a href="/about/privacy/">Privacy Statement</a></li>
            </ul>
        </li>
        <li><a href="/contact/"> Contact</a></li>
    </ul>
</div><!---------- END MAIN NAV ---------->
	




<div class="col_12 boxed column">

  <div class="col_9 column">

  
<h1><span>181</span>Generating Static Proxy Classes - Part 2</h1><h5><span>Author: Dr. Heinz M. Kabutz</span><span>Date: 2010-03-01</span><span>Java Version: 6</span><span>Category:
      <a href="/archive/Performance.html">Performance</a></span></h5><div class="clear">&nbsp;</div><hr><p><strong>Abstract:</strong>&nbsp;In this newsletter, we show how the Generator described in our previous issue can
   be used to create virtual proxy classes statically, that is, by generating code instead
   of using dynamic proxies.</p><div class="clear">&nbsp;</div><hr>

<p>
   A warm welcome to the 181st edition of<b>The Java(tm) Specialists' Newsletter</b>. Another day,
   another airport. This time in Athens Elefterios Venizelos en
   route to DÃ¼sseldorf, Germany, for a <a href="/courses/master/">Java Specialist Master
      Course</a> in German. This afternoon I am visiting my
   grandmother who is staying with my aunt and uncle in Hennef.
   My "Oma" is celebrating her ##th birthday in two week's time.
   Instead of boasting about her amazing genes and longevity, I
   will give you a clue of our ages and let you figure it out.
   Last year, I was a prime number of years old. This year, my
   grandmother turns a prime number of years. (You could say,
   she is <i>in her prime</i> :-)) We have this in common: My
   age last year and her age this year are both circular primes.
   Furthermore, both prime numbers have cousins. Both number are
   good primes, but mine is not happy. At least it is lucky :-)
   </p>

<p><b>javaspecialists.teachable.com:</b> Please visit our
   new <a href="https://javaspecialists.teachable.com">self-study course catalog</a> to see how you can upskill
   your Java knowledge.
   </p><h3>Generating Static Proxy Classes - 2/2</h3>

<p>
   This is the second part of our Generating Static Proxy Classes
   newsletters.  <a href="/archive/Issue180-Generating-Static-Proxy-Classes---Part-1.html">Click here to read the
      first part.</a>
   </p>

<p>
   Since there is a lot of code in our last two newsletters, I
   have put all of the source files onto our <a href="https://github.com/kabutz/javaspecialists/" target="_blank">public GitHub
      repository</a>.
   </p>

<p>
   Let us imagine a company with moral fibre. This altruism is
   an expensive luxury to possess, especially when no one is
   asking for it. Thus instead of constructing a "real" moral
   fibre object, the company will instead contain a "virtual"
   moral fibre. This "virtual" object will then create the
   "real" moral fibre only when it is used for the first time,
   which in our case will be when any method is called.
   </p>

<p>
   We start with the company class, which has three
   methods: makeMoney(), damageEnvironment() and
   becomeFocusOfMediaAttention(). You can easily see that the
   company only uses its moral fibre object for the first time
   when the media does an expo on its business practices. We
   could thus create the moral fibre object lazily. This is what
   the virtual proxy design pattern does for us.
   </p>

<pre>
<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/Company.java">Company</a> {
  <b><FONT COLOR="#000080">private final</FONT></b> String name;
  <b><FONT COLOR="#000080">private final</FONT></b> MoralFibre moralFibre;
  <b><FONT COLOR="#000080">private double</FONT></b> cash;

  <b><FONT COLOR="#000080">public</FONT></b> Company(String name, <b><FONT COLOR="#000080">double</FONT></b> cash, MoralFibre moralFibre) {
    <b><FONT COLOR="#000080">this</FONT></b>.name = name;
    <b><FONT COLOR="#000080">this</FONT></b>.cash = cash;
    <b><FONT COLOR="#000080">this</FONT></b>.moralFibre = moralFibre;
    System.out.println(<b><FONT COLOR="#E1691A">"Company constructed: "</FONT></b> + <b><FONT COLOR="#000080">this</FONT></b>);    
  }

  <b><FONT COLOR="#000080">public void</FONT></b> damageEnvironment() {
    cash += <FONT COLOR="#0000ff">4000000</FONT>;
    System.out.println(<b><FONT COLOR="#E1691A">"Company.damageEnvironment(): "</FONT></b> + <b><FONT COLOR="#000080">this</FONT></b>);
  }

  <b><FONT COLOR="#000080">public void</FONT></b> makeMoney() {
    cash += <FONT COLOR="#0000ff">1000000</FONT>;
    System.out.println(<b><FONT COLOR="#E1691A">"Company.makeMoney(): "</FONT></b> + <b><FONT COLOR="#000080">this</FONT></b>);
  }

  <b><FONT COLOR="#000080">public void</FONT></b> becomeFocusOfMediaAttention() {
    cash -= moralFibre.actSociallyResponsibly();
    cash -= moralFibre.cleanupEnvironment();
    cash -= moralFibre.empowerEmployees();
    System.out.println(<b><FONT COLOR="#E1691A">"Look how good we are... "</FONT></b> + <b><FONT COLOR="#000080">this</FONT></b>);
  }

  <b><FONT COLOR="#000080">public</FONT></b> String toString() {
    <b><FONT COLOR="#000080">return</FONT></b> String.format(<b><FONT COLOR="#E1691A">"%s has $ %.2f"</FONT></b>, name, cash);
  }
}
  </pre>

<p>
   The moral fibre interface contains several methods that show
   how good the company actually is:
   </p>

<pre>
<b><FONT COLOR="#000080">public interface</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/MoralFibre.java">MoralFibre</a> {
  <b><FONT COLOR="#000080">double</FONT></b> actSociallyResponsibly();
  <b><FONT COLOR="#000080">double</FONT></b> empowerEmployees();
  <b><FONT COLOR="#000080">double</FONT></b> cleanupEnvironment();
}
  </pre>

<p>
   The real moral fibre object is expensive to create, which I
   show by making it contain a very large byte array. It also
   prints out a debug message in its initializer block, this
   will help us see when it in actual fact is constructed.
   </p>

<pre>
<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/MoralFibreImpl.java">MoralFibreImpl</a> <b><FONT COLOR="#000080">implements</FONT></b> MoralFibre {
  <i><FONT COLOR="808080">// very expensive to create moral fibre!</FONT></i>
  <b><FONT COLOR="#000080">private byte</FONT></b>[] costOfMoralFibre = <b><FONT COLOR="#000080">new byte</FONT></b>[<FONT COLOR="#0000ff">900</FONT> * <FONT COLOR="#0000ff">1000</FONT>];

  {
    System.out.println(<b><FONT COLOR="#E1691A">"Moral Fibre Created!"</FONT></b>);
  }

  <i><FONT COLOR="808080">// AIDS orphans</FONT></i>
  <b><FONT COLOR="#000080">public double</FONT></b> actSociallyResponsibly() {
    <b><FONT COLOR="#000080">return</FONT></b> costOfMoralFibre.length / <FONT COLOR="#0000ff">3</FONT>;
  }

  <i><FONT COLOR="808080">// shares to employees</FONT></i>
  <b><FONT COLOR="#000080">public</FONT></b> double empowerEmployees() {
    <b><FONT COLOR="#000080">return</FONT></b> costOfMoralFibre.length / <FONT COLOR="#0000ff">3</FONT>;
  }

  <i><FONT COLOR="808080">// oiled sea birds</FONT></i>
  <b><FONT COLOR="#000080">public double</FONT></b> cleanupEnvironment() {
    <b><FONT COLOR="#000080">return</FONT></b> costOfMoralFibre.length / <FONT COLOR="#0000ff">3</FONT>;
  }
}
  </pre>

<p>
   The virtual proxies then create the MoralFibreImpl object
   only when the do-good methods are called for the first time.
   There are several approaches that we could use.  We could
   take great care to never create more than one real object,
   by synchronizing the construction of the MoralFibreImpl.
   Or we could increase throughput slightly by using the
   AtomicReference, at the risk of <i>occasionally</i> making
   multiple objects.  If we do not need to care about
   concurrency at all, then we can simply ignore this problem.
   </p>

<p>
   Since the three solutions differ only in the way they create
   the real moral fibre, we can introduce an abstract superclass,
   with the do-good functions delegating to the result of the 
   realSubject() method:
   </p>

<pre>
<b><FONT COLOR="#000080">public abstract class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/handcoded/VirtualMoralFibre.java">VirtualMoralFibre</a> <b><FONT COLOR="#000080">implements</FONT></b> MoralFibre {
  <b><FONT COLOR="#000080">protected abstract</FONT></b> MoralFibre realSubject();

  <b><FONT COLOR="#000080">public final double</FONT></b> actSociallyResponsibly() {
    <b><FONT COLOR="#000080">return</FONT></b> realSubject().actSociallyResponsibly();
  }

  <b><FONT COLOR="#000080">public final double</FONT></b> empowerEmployees() {
    <b><FONT COLOR="#000080">return</FONT></b> realSubject().empowerEmployees();
  }

  <b><FONT COLOR="#000080">public final double</FONT></b> cleanupEnvironment() {
    <b><FONT COLOR="#000080">return</FONT></b> realSubject().cleanupEnvironment();
  }
}
  </pre>

<p>
   We will start with the easiest solution, which is when we
   do not cater for concurrent access in our virtual proxy:
   </p>

<pre>
<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/handcoded/VirtualMoralFibreNotThreadSafe.java">VirtualMoralFibreNotThreadSafe</a> <b><FONT COLOR="#000080">extends</FONT></b> VirtualMoralFibre {
  <b><FONT COLOR="#000080">private</FONT></b> MoralFibre realSubject;

  <b><FONT COLOR="#000080">protected</FONT></b> MoralFibre realSubject() {
    <b><FONT COLOR="#000080">if</FONT></b> (realSubject == <b><FONT COLOR="#000080">null</FONT></b>) {
      realSubject = <b><FONT COLOR="#000080">new</FONT></b> MoralFibreImpl();
    }
    <b><FONT COLOR="#000080">return</FONT></b> realSubject;
  }
}
  </pre>

<p>
   The next hand-written virtual proxy uses atomic references
   that may <i>sometimes</i> create multiple instances.  If this
   happens, we use the first reference that was set:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.util.concurrent.atomic.*;

<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/handcoded/VirtualMoralFibreLockFree.java">VirtualMoralFibreLockFree</a> <b><FONT COLOR="#000080">extends</FONT></b> VirtualMoralFibre {
  <b><FONT COLOR="#000080">private final</FONT></b> AtomicReference&lt;MoralFibre&gt; realSubject =
      <b><FONT COLOR="#000080">new</FONT></b> AtomicReference&lt;MoralFibre&gt;();

  <b><FONT COLOR="#000080">protected</FONT></b> MoralFibre realSubject() {
    MoralFibre subject = realSubject.get();
    <b><FONT COLOR="#000080">if</FONT></b> (subject == <b><FONT COLOR="#000080">null</FONT></b>) {
      subject = <b><FONT COLOR="#000080">new</FONT></b> MoralFibreImpl();
      <b><FONT COLOR="#000080">if</FONT></b> (!realSubject.compareAndSet(<b><FONT COLOR="#000080">null</FONT></b>, subject)) {
        subject = realSubject.get();
      }
    }
    <b><FONT COLOR="#000080">return</FONT></b> subject;
  }
}
  </pre>

<p>
   The most tricky is the last one, where we try to avoid locking
   outright, but still only have one instance ever created.  In
   this solution, similar to what you can find in <a href="/archive/Issue163-Book-Review-Effective-Java-2nd-Edition.html">Effective Java 2nd Ed, Joshua Bloch</a>,
   we minimize the number of memory reads by writing our results
   to local variables:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.util.concurrent.locks.*;

<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/handcoded/VirtualMoralFibreThreadSafe.java">VirtualMoralFibreThreadSafe</a> <b><FONT COLOR="#000080">extends</FONT></b> VirtualMoralFibre {
  <b><FONT COLOR="#000080">private volatile</FONT></b> MoralFibre realSubject;
  <b><FONT COLOR="#000080">private final</FONT></b> Lock initializationLock = <b><FONT COLOR="#000080">new</FONT></b> ReentrantLock();

  <b><FONT COLOR="#000080">protected</FONT></b> MoralFibre realSubject() {
    MoralFibre result = realSubject;
    <b><FONT COLOR="#000080">if</FONT></b> (result == <b><FONT COLOR="#000080">null</FONT></b>) {
      initializationLock.lock();
      <b><FONT COLOR="#000080">try</FONT></b> {
        result = realSubject;
        <b><FONT COLOR="#000080">if</FONT></b> (result == <b><FONT COLOR="#000080">null</FONT></b>) {
          result = realSubject = <b><FONT COLOR="#000080">new</FONT></b> MoralFibreImpl();
        }
      } <b><FONT COLOR="#000080">finally</FONT></b> {
        initializationLock.unlock();
      }
    }
    <b><FONT COLOR="#000080">return</FONT></b> result;
  }
}
  </pre>

<p>
   These hand-written virtual proxies work, but are a lot
   of effort to write and maintain. A good programmer has to be
   just the right amount of lazy. If he is too lazy, he will
   simply copy &amp; paste his code and modify a few lines. In
   the end, his codebase will be unmaintainable, but he might be
   promoted due to the amazing lines-of-code (LOC) he has
   achieved. If he is not lazy enough, he will not shirk from
   doing something over and over again. Both character flaws
   (too lazy and too eager) result in code that is hard to
   maintain.
   </p>

<p>
   We could construct a company with a virtual moral fibre as
   follows:
   </p>

<pre>
<b><FONT COLOR="#000080">new</FONT></b> Company(<b><FONT COLOR="#E1691A">"Cretesoft"</FONT></b>,<FONT COLOR="#0000ff">20000.0</FONT>, <b><FONT COLOR="#000080">new</FONT></b> VirtualMoralFibreLockFree())
  </pre>

<h3>Using Dynamic Proxies</h3>

<p>
   Instead of writing the code by hand, we could also use a
   dynamic proxy.  This only works when the proxied type is an
   interface.  Unfortunately there is a run-time overhead
   every time we call any of the dynamic proxy's methods.
   Here is how the dynamic proxy invocation handler would look:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.lang.reflect.*;

<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/VirtualDynamicProxyNotThreadSafe.java">VirtualDynamicProxyNotThreadSafe</a>
    <b><FONT COLOR="#000080">implements</FONT></b> InvocationHandler {
  <b><FONT COLOR="#000080">private final</FONT></b> Class realSubjectClass;
  <b><FONT COLOR="#000080">private</FONT></b> Object realSubject;

  <b><FONT COLOR="#000080">public</FONT></b> VirtualDynamicProxyNotThreadSafe(Class realSubjectClass) {
    <b><FONT COLOR="#000080">this</FONT></b>.realSubjectClass = realSubjectClass;
  }

  <b><FONT COLOR="#000080">private</FONT></b> Object realSubject() <b><FONT COLOR="#000080">throws</FONT></b> Exception {
    <b><FONT COLOR="#000080">if</FONT></b> (realSubject == <b><FONT COLOR="#000080">null</FONT></b>) {
      realSubject = realSubjectClass.newInstance();
    }
    <b><FONT COLOR="#000080">return</FONT></b> realSubject;
  }

  <b><FONT COLOR="#000080">public</FONT></b> Object invoke(
      Object proxy, Method method, Object[] args)
      <b><FONT COLOR="#000080">throws</FONT></b> Throwable {
    <b><FONT COLOR="#000080">return</FONT></b> method.invoke(realSubject(), args);
  }
}
  </pre>

<p>
   The other concurrency types are left as an exercise for the
   reader :-)
   </p>

<p>
   (As an aside, you should actually never call
   Class.newInstance().  Better is to use:
   Class.getConstructor((Class[])null).newInstance().
   Come to my course if you want to know why :-))
   </p>
<h3>Generating Proxies as Static Classes</h3>

<p>
   Instead of using a dynamic proxy, we could also generate
   code according to the class structure that we are trying to
   wrap.  We could then use our <a href="/archive/Issue180-Generating-Static-Proxy-Classes---Part-1.html">Generator</a> to compile the class and
   load it into our class loader. When we choose to generate a
   proxy, we want to specify whether it is dynamic or static and
   what the concurrency level is. We do that with two enums:
   </p>

<pre>
<b><FONT COLOR="#000080">public enum</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/ProxyType.java">ProxyType</a> {
  STATIC, DYNAMIC
}

<b><FONT COLOR="#000080">public enum</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/Concurrency.java">Concurrency</a> {
  NONE, SOME_DUPLICATES, NO_DUPLICATES;
}
  </pre>

<p>
   When we generate class names, we want them to appear as they
   would in source code.  This means formatting arrays correctly
   and hiding references to the package java.lang.
   </p>

<pre>
<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/Util.java">Util</a> {
  <b><FONT COLOR="#000080">public static</FONT></b> String prettyPrint(Class clazz) {
    <b><FONT COLOR="#000080">return</FONT></b> prettyPrint(clazz, <b><FONT COLOR="#E1691A">""</FONT></b>);
  }

  <b><FONT COLOR="#000080">public static</FONT></b> String prettyPrint(Class c, String postfix) {
    <b><FONT COLOR="#000080">if</FONT></b> (c.isArray()) {
      <b><FONT COLOR="#000080">return</FONT></b> prettyPrint(c.getComponentType(), postfix + <b><FONT COLOR="#E1691A">"[]"</FONT></b>);
    } <b><FONT COLOR="#000080">else</FONT></b> {
      Package pack = c.getPackage();
      <b><FONT COLOR="#000080">if</FONT></b> (pack != <b><FONT COLOR="#000080">null</FONT></b> &amp;&amp; pack.getName().equals(<b><FONT COLOR="#E1691A">"java.lang"</FONT></b>)) {
        <b><FONT COLOR="#000080">return</FONT></b> c.getSimpleName() + postfix;
      }
      <b><FONT COLOR="#000080">return</FONT></b> c.getName() + postfix;
    }
  }
}
  </pre>
<p>
   The ProxyGenerator builds up the CharSequence for the proxy
   subject, taking into account the concurrency level and proxy
   type.  Classes that were already generated are kept in a
   WeakHashMap, to avoid making the same class twice.  The cache
   is similar to what you would probably find in the
   <code>java.lang.reflect.Proxy</code> class.
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> eu.javaspecialists.tjsn.util.codegen.*;

<b><FONT COLOR="#000080">import</FONT></b> java.lang.reflect.*;
<b><FONT COLOR="#000080">import</FONT></b> java.util.*;

<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/ProxyGenerator.java">ProxyGenerator</a> {
  <b><FONT COLOR="#000080">private static final</FONT></b> WeakHashMap cache = <b><FONT COLOR="#000080">new</FONT></b> WeakHashMap();

  <b><FONT COLOR="#000080">public static</FONT></b> &lt;T&gt; T make(
      Class&lt;T&gt; subject,
      Class&lt;? <b><FONT COLOR="#000080">extends</FONT></b> T&gt; realClass,
      Concurrency concurrency,
      ProxyType type) {
    <b><FONT COLOR="#000080">return</FONT></b> make(subject.getClassLoader(),
        subject, realClass, concurrency, type);
  }

  <b><FONT COLOR="#000080">public static</FONT></b> &lt;T&gt; T make(
      Class&lt;T&gt; subject, Class&lt;? <b><FONT COLOR="#000080">extends</FONT></b> T&gt; realClass,
      Concurrency concurrency) {
    <b><FONT COLOR="#000080">return</FONT></b> make(subject, realClass, concurrency,
        ProxyType.STATIC);
  }

  <b><FONT COLOR="#000080">public static</FONT></b> &lt;T&gt; T make(ClassLoader loader,
                           Class&lt;T&gt; subject,
                           Class&lt;? <b><FONT COLOR="#000080">extends</FONT></b> T&gt; realClass,
                           Concurrency concurrency,
                           ProxyType type) {

    Object proxy = <b><FONT COLOR="#000080">null</FONT></b>;
    <b><FONT COLOR="#000080">if</FONT></b> (type == ProxyType.STATIC) {
      proxy = createStaticProxy(loader, subject,
          realClass, concurrency);
    } <b><FONT COLOR="#000080">else if</FONT></b> (type == ProxyType.DYNAMIC) {
      proxy = createDynamicProxy(loader,
          subject, realClass, concurrency);
    }
    <b><FONT COLOR="#000080">return</FONT></b> subject.cast(proxy);
  }

  <b><FONT COLOR="#000080">private static</FONT></b> Object createStaticProxy(
      ClassLoader loader, Class subject,
      Class realClass, Concurrency concurrency) {
    Map clcache;
    <b><FONT COLOR="#000080">synchronized</FONT></b> (cache) {
      clcache = (Map) cache.get(loader);
      <b><FONT COLOR="#000080">if</FONT></b> (clcache == <b><FONT COLOR="#000080">null</FONT></b>) {
        cache.put(loader, clcache = <b><FONT COLOR="#000080">new</FONT></b> HashMap());
      }
    }

    <b><FONT COLOR="#000080">try</FONT></b> {
      Class clazz;
      CacheKey key = <b><FONT COLOR="#000080">new</FONT></b> CacheKey(subject, concurrency);
      <b><FONT COLOR="#000080">synchronized</FONT></b> (clcache) {
        clazz = (Class) clcache.get(key);
        <b><FONT COLOR="#000080">if</FONT></b> (clazz == <b><FONT COLOR="#000080">null</FONT></b>) {
          VirtualProxySourceGenerator vpsg = create(subject,
              realClass, concurrency);
          clazz = Generator.make(loader, vpsg.getProxyName(),
              vpsg.getCharSequence());
          clcache.put(key, clazz);
        }
      }
      <b><FONT COLOR="#000080">return</FONT></b> clazz.newInstance();
    } <b><FONT COLOR="#000080">catch</FONT></b> (RuntimeException e) {
      <b><FONT COLOR="#000080">throw</FONT></b> e;
    } <b><FONT COLOR="#000080">catch</FONT></b> (Exception e) {
      <b><FONT COLOR="#000080">throw new</FONT></b> IllegalArgumentException(e);
    }
  }

  <b><FONT COLOR="#000080">private static</FONT></b> VirtualProxySourceGenerator create(
      Class subject, Class realClass,
      Concurrency concurrency) {
    <b><FONT COLOR="#000080">switch</FONT></b> (concurrency) {
      <b><FONT COLOR="#000080">case</FONT></b> NONE:
        <b><FONT COLOR="#000080">return new</FONT></b> VirtualProxySourceGeneratorNotThreadsafe(
            subject, realClass
        );
      <b><FONT COLOR="#000080">case</FONT></b> SOME_DUPLICATES:
        <b><FONT COLOR="#000080">return new</FONT></b> VirtualProxySourceGeneratorSomeDuplicates(
            subject, realClass
        );
      <b><FONT COLOR="#000080">case</FONT></b> NO_DUPLICATES:
        <b><FONT COLOR="#000080">return new</FONT></b> VirtualProxySourceGeneratorNoDuplicates(
            subject, realClass
        );
      <b><FONT COLOR="#000080">default</FONT></b>:
        <b><FONT COLOR="#000080">throw new</FONT></b> IllegalArgumentException(
            <b><FONT COLOR="#E1691A">"Unsupported Concurrency: "</FONT></b> + concurrency);
    }
  }

  <b><FONT COLOR="#000080">private static</FONT></b> Object createDynamicProxy(
      ClassLoader loader, Class subject,
      Class realClass, Concurrency concurrency) {
    <b><FONT COLOR="#000080">if</FONT></b> (concurrency != Concurrency.NONE) {
      <b><FONT COLOR="#000080">throw new</FONT></b> IllegalArgumentException(
          <b><FONT COLOR="#E1691A">"Unsupported Concurrency: "</FONT></b> + concurrency);
    }
    <b><FONT COLOR="#000080">return</FONT></b> Proxy.newProxyInstance(
        loader,
        <b><FONT COLOR="#000080">new</FONT></b> Class&lt;?&gt;[]{subject},
        <b><FONT COLOR="#000080">new</FONT></b> VirtualDynamicProxyNotThreadSafe(realClass));
  }

  <b><FONT COLOR="#000080">private static class</FONT></b> CacheKey {
    <b><FONT COLOR="#000080">private final</FONT></b> Class subject;
    <b><FONT COLOR="#000080">private final</FONT></b> Concurrency concurrency;

    <b><FONT COLOR="#000080">private</FONT></b> CacheKey(Class subject, Concurrency concurrency) {
      <b><FONT COLOR="#000080">this</FONT></b>.subject = subject;
      <b><FONT COLOR="#000080">this</FONT></b>.concurrency = concurrency;
    }

    <b><FONT COLOR="#000080">public boolean</FONT></b> equals(Object o) {
      <b><FONT COLOR="#000080">if</FONT></b> (<b><FONT COLOR="#000080">this</FONT></b> == o) <b><FONT COLOR="#000080">return true</FONT></b>;
      <b><FONT COLOR="#000080">if</FONT></b> (o == <b><FONT COLOR="#000080">null</FONT></b> || getClass() != o.getClass()) <b><FONT COLOR="#000080">return false</FONT></b>;

      CacheKey that = (CacheKey) o;
      <b><FONT COLOR="#000080">if</FONT></b> (concurrency != that.concurrency) <b><FONT COLOR="#000080">return false</FONT></b>;
      <b><FONT COLOR="#000080">return</FONT></b> subject.equals(<b><FONT COLOR="#000080">that</FONT></b>.subject);
    }

    <b><FONT COLOR="#000080">public int</FONT></b> hashCode() {
      <b><FONT COLOR="#000080">return</FONT></b> <FONT COLOR="#0000ff">31</FONT> * subject.hashCode() + concurrency.hashCode();
    }
  }
}
  </pre>

<p>
   The actual VirtualProxySourceGenerator builds up the
   CharSequence based on the class structure of the proxy
   subject, in our case the MoralFibre interface:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.io.*;
<b><FONT COLOR="#000080">import</FONT></b> java.lang.reflect.*;

<b><FONT COLOR="#000080">public abstract class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/VirtualProxySourceGenerator.java">VirtualProxySourceGenerator</a> {
  <b><FONT COLOR="#000080">protected final</FONT></b> Class subject;
  <b><FONT COLOR="#000080">protected final</FONT></b> Class realSubject;
  <b><FONT COLOR="#000080">private final</FONT></b> String proxy;
  <b><FONT COLOR="#000080">private</FONT></b> CharSequence charSequence;

  <b><FONT COLOR="#000080">public</FONT></b> VirtualProxySourceGenerator(
      Class subject, Class realSubject, Concurrency type) {
    <b><FONT COLOR="#000080">this</FONT></b>.subject = subject;
    <b><FONT COLOR="#000080">this</FONT></b>.realSubject = realSubject;
    <b><FONT COLOR="#000080">this</FONT></b>.proxy = makeProxyName(subject, type);
  }

  <b><FONT COLOR="#000080">private static</FONT></b> String makeProxyName(Class subject,
                                      Concurrency type) {
    <b><FONT COLOR="#000080">return</FONT></b> <b><FONT COLOR="#E1691A">"$$_"</FONT></b> + subject.getName().replace('.', '_') +
        <b><FONT COLOR="#E1691A">"Proxy_"</FONT></b> + Integer.toHexString(System.identityHashCode(
        subject.getClassLoader())) + <b><FONT COLOR="#E1691A">"_"</FONT></b> + type;
  }

  <b><FONT COLOR="#000080">public</FONT></b> String getProxyName() {
    <b><FONT COLOR="#000080">return</FONT></b> proxy;
  }

  <b><FONT COLOR="#000080">public</FONT></b> CharSequence getCharSequence() {
    <b><FONT COLOR="#000080">if</FONT></b> (charSequence == <b><FONT COLOR="#000080">null</FONT></b>) {
      StringWriter sw = <b><FONT COLOR="#000080">new</FONT></b> StringWriter();
      generateProxyClass(<b><FONT COLOR="#000080">new</FONT></b> PrintWriter(sw));
      charSequence = sw.getBuffer();
    }
    <b><FONT COLOR="#000080">return</FONT></b> charSequence;
  }

  <b><FONT COLOR="#000080">private void</FONT></b> generateProxyClass(PrintWriter out) {
    addClassDefinition(out);
    addProxyBody(out);
    out.close();
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addProxyBody(PrintWriter out) {
    addRealSubjectCreation(out, subject.getName(),
        realSubject.getName());
    addProxiedMethods(out);
    out.println(<b><FONT COLOR="#E1691A">"}"</FONT></b>);
  }

  <b><FONT COLOR="#000080">protected abstract void</FONT></b> addRealSubjectCreation(
      PrintWriter out, String name, String realName);

  <b><FONT COLOR="#000080">private void</FONT></b> addClassDefinition(PrintWriter out) {
    addImports(out);
    out.printf(<b><FONT COLOR="#E1691A">"public class %s %s %s {%n"</FONT></b>,
        proxy, getInheritanceType(subject), subject.getName());
  }

  <b><FONT COLOR="#000080">private</FONT></b> String getInheritanceType(Class subject) {
    <b><FONT COLOR="#000080">return</FONT></b> subject.isInterface() ? <b><FONT COLOR="#E1691A">"implements"</FONT></b> : <b><FONT COLOR="#E1691A">"extends"</FONT></b>;
  }

  <b><FONT COLOR="#000080">protected void</FONT></b> addImports(PrintWriter out) {
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addToStringIfInterface(PrintWriter out) {
    <b><FONT COLOR="#000080">if</FONT></b> (subject.isInterface()) {
      out.println();
      out.println(<b><FONT COLOR="#E1691A">"  public String toString() {"</FONT></b>);
      out.println(<b><FONT COLOR="#E1691A">"    return realSubject().toString();"</FONT></b>);
      out.println(<b><FONT COLOR="#E1691A">"  }"</FONT></b>);
    }
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addProxiedMethods(PrintWriter out) {
    <b><FONT COLOR="#000080">for</FONT></b> (Method m : subject.getMethods()) {
      addProxiedMethod(out, m);
    }
    addToStringIfInterface(out);
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addProxiedMethod(PrintWriter out, Method m) {
    <b><FONT COLOR="#000080">if</FONT></b> (Modifier.isFinal(m.getModifiers())) <b><FONT COLOR="#000080">return</FONT></b>;
    addMethodSignature(out, m);
    addMethodBody(out, m);
    out.printf(<b><FONT COLOR="#E1691A">");%n  }%n"</FONT></b>);
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addMethodSignature(PrintWriter out, Method m) {
    out.printf(<b><FONT COLOR="#E1691A">"%n  public %s"</FONT></b>, Util.prettyPrint(m.getReturnType()));
    out.printf(<b><FONT COLOR="#E1691A">" %s("</FONT></b>, m.getName());
    addParameterList(out, m);
    out.printf(<b><FONT COLOR="#E1691A">") {%n    "</FONT></b>);
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addParameterList(PrintWriter out, Method m) {
    Class&lt;?&gt;[] types = m.getParameterTypes();
    <b><FONT COLOR="#000080">for</FONT></b> (<b><FONT COLOR="#000080">int</FONT></b> i = <FONT COLOR="#0000ff">0</FONT>; i &lt; types.length; i++) {
      String next = i == types.length - <FONT COLOR="#0000ff">1</FONT> ? <b><FONT COLOR="#E1691A">""</FONT></b> : <b><FONT COLOR="#E1691A">", "</FONT></b>;
      out.printf(<b><FONT COLOR="#E1691A">"%s p%d%s"</FONT></b>, Util.prettyPrint(types[i]), i, next);
    }
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addMethodBody(PrintWriter out, Method m) {
    addReturnKeyword(out, m);
    addMethodBodyDelegatingToRealSubject(out, m);
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addReturnKeyword(PrintWriter out, Method m) {
    <b><FONT COLOR="#000080">if</FONT></b> (m.getReturnType() != <b><FONT COLOR="#000080">void</FONT></b>.<b><FONT COLOR="#000080">class</FONT></b>) {
      out.print(<b><FONT COLOR="#E1691A">"return "</FONT></b>);
    }
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addMethodBodyDelegatingToRealSubject(
      PrintWriter out, Method m) {
    out.printf(<b><FONT COLOR="#E1691A">"realSubject().%s("</FONT></b>, m.getName());
    addMethodCall(out, m);
  }

  <b><FONT COLOR="#000080">private void</FONT></b> addMethodCall(PrintWriter out, Method m) {
    Class&lt;?&gt;[] types = m.getParameterTypes();
    <b><FONT COLOR="#000080">for</FONT></b> (<b><FONT COLOR="#000080">int</FONT></b> i = <FONT COLOR="#0000ff">0</FONT>; i &lt; types.length; i++) {
      String next = i == types.length - <FONT COLOR="#0000ff">1</FONT> ? <b><FONT COLOR="#E1691A">""</FONT></b> : <b><FONT COLOR="#E1691A">", "</FONT></b>;
      out.printf(<b><FONT COLOR="#E1691A">"p%d%s"</FONT></b>, i, next);
    }
  }
}
  </pre>

<p>
   We then have different subclasses for each of the concurrency
   levels specified.  For example, if we do not want it to be
   threadsafe, we can just use this class.  You can easily see
   how similar the generated code will be to the hand written
   virtual proxy:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.io.*;

<b><FONT COLOR="#000080">class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/VirtualProxySourceGeneratorNotThreadsafe.java">VirtualProxySourceGeneratorNotThreadsafe</a>
    <b><FONT COLOR="#000080">extends</FONT></b> VirtualProxySourceGenerator {

  <b><FONT COLOR="#000080">public</FONT></b> VirtualProxySourceGeneratorNotThreadsafe(
      Class subject, Class realSubject) {
    <b><FONT COLOR="#000080">super</FONT></b>(subject, realSubject, Concurrency.NONE);
  }

  <b><FONT COLOR="#000080">protected void</FONT></b> addRealSubjectCreation(PrintWriter out,
                                        String name,
                                        String realName) {
    out.printf(<b><FONT COLOR="#E1691A">"  private %s realSubject;%n"</FONT></b>, name);
    out.println();
    out.printf(<b><FONT COLOR="#E1691A">"  private %s realSubject() {%n"</FONT></b>, name);
    out.printf(<b><FONT COLOR="#E1691A">"    if (realSubject == null) {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"      realSubject = new %s();%n"</FONT></b>, realName);
    out.println(<b><FONT COLOR="#E1691A">"    }"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"    return realSubject;"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"  }"</FONT></b>);
  }
}
  </pre>

<p>
   If we want to have less possible duplicates, we can this
   class to generate the virtual proxy.  It uses the
   AtomicReference, which in some cases might construct
   duplicates:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.io.*;

<b><FONT COLOR="#000080">class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/VirtualProxySourceGeneratorSomeDuplicates.java">VirtualProxySourceGeneratorSomeDuplicates</a>
    <b><FONT COLOR="#000080">extends</FONT></b> VirtualProxySourceGenerator {

  <b><FONT COLOR="#000080">public</FONT></b> VirtualProxySourceGeneratorSomeDuplicates(
      Class subject, Class realSubject) {
    <b><FONT COLOR="#000080">super</FONT></b>(subject, realSubject, Concurrency.SOME_DUPLICATES);
  }

  <b><FONT COLOR="#000080">protected void</FONT></b> addImports(PrintWriter out) {
    out.println(<b><FONT COLOR="#E1691A">"import java.util.concurrent.atomic.*;"</FONT></b>);
    out.println();
  }

  <b><FONT COLOR="#000080">protected void</FONT></b> addRealSubjectCreation(PrintWriter out,
                                        String name,
                                        String realName) {
    out.printf(<b><FONT COLOR="#E1691A">"  private final AtomicReference&lt;%s&gt; "</FONT></b> +
        <b><FONT COLOR="#E1691A">"ref = new AtomicReference&lt;%1$s&gt;();%n"</FONT></b>, name);
    out.println();
    out.printf(<b><FONT COLOR="#E1691A">"  private %s realSubject() {%n"</FONT></b>, name);
    out.printf(<b><FONT COLOR="#E1691A">"    %s result = ref.get()%n;"</FONT></b>, name);
    out.printf(<b><FONT COLOR="#E1691A">"    if (result == null) {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"      result = new %s();%n"</FONT></b>, realName);
    out.printf(<b><FONT COLOR="#E1691A">"      if (!ref.compareAndSet(null, result)) {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"        result = ref.get();%n"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"      }"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"    }"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"    return result;"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"  }"</FONT></b>);
  }
}
  </pre>

<p>
   If we want to have absolutely no duplicates, we could use
   the following class to generate our virtual proxy.  In this
   case, we need to also import the
   <code>java.util.concurrent.*</code> package for the
   <code>Lock</code> and <code>ReentrantLock</code> classes:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> java.io.*;

<b><FONT COLOR="#000080">class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/util/proxy/VirtualProxySourceGeneratorNoDuplicates.java">VirtualProxySourceGeneratorNoDuplicates</a>
    <b><FONT COLOR="#000080">extends</FONT></b> VirtualProxySourceGenerator {

  <b><FONT COLOR="#000080">public</FONT></b> VirtualProxySourceGeneratorNoDuplicates(
      Class subject, Class realSubject) {
    <b><FONT COLOR="#000080">super</FONT></b>(subject, realSubject, Concurrency.NO_DUPLICATES);
  }

  <b><FONT COLOR="#000080">protected void</FONT></b> addImports(PrintWriter out) {
    out.println(<b><FONT COLOR="#E1691A">"import java.util.concurrent.locks.*;"</FONT></b>);
    out.println();
  }

  <b><FONT COLOR="#000080">protected void</FONT></b> addRealSubjectCreation(PrintWriter out,
                                        String name,
                                        String realName) {
    out.printf(<b><FONT COLOR="#E1691A">"  private volatile %s realSubject;%n"</FONT></b>, name);
    out.println(<b><FONT COLOR="#E1691A">"  private final Lock initializationLock = "</FONT></b> +
        <b><FONT COLOR="#E1691A">"new ReentrantLock();"</FONT></b>);
    out.println();
    out.printf(<b><FONT COLOR="#E1691A">"  private %s realSubject() {%n"</FONT></b>, name);
    out.printf(<b><FONT COLOR="#E1691A">"    %s result = realSubject;%n"</FONT></b>, name);
    out.printf(<b><FONT COLOR="#E1691A">"    if (result == null) {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"      initializationLock.lock();%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"      try {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"        result = realSubject;%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"        if (result == null) {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"          result = realSubject = new %s();%n"</FONT></b>,
        realName);
    out.printf(<b><FONT COLOR="#E1691A">"        }%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"      } finally {%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"        initializationLock.unlock();%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"      }%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"    }%n"</FONT></b>);
    out.printf(<b><FONT COLOR="#E1691A">"    return result;%n"</FONT></b>);
    out.println(<b><FONT COLOR="#E1691A">"  }"</FONT></b>);
  }
}
  </pre>

<p>
   You probably noticed that these generator classes are all
   package access.  We cannot use them directly, rather, we need
   to call the ProxyGenerator's factory methods.
   </p>

<p>
   Here is some test code that makes two companies.  The first
   one is constructed with a real instance of MoralFibre.  The
   second just contains a virtual proxy:
   </p>
<pre>
<b><FONT COLOR="#000080">import</FONT></b> example.*;
<b><FONT COLOR="#000080">import</FONT></b> util.proxy.*;

<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/CompanyTest.java">CompanyTest</a> {
  <b><FONT COLOR="#000080">public static void</FONT></b> main(String[] args) {
    Company company = <b><FONT COLOR="#000080">new</FONT></b> Company(<b><FONT COLOR="#E1691A">"Cretesoft"</FONT></b>, <FONT COLOR="#0000ff">10000.0</FONT>,
        <b><FONT COLOR="#000080">new</FONT></b> MoralFibreImpl());
    company.makeMoney();
    company.damageEnvironment();
    company.becomeFocusOfMediaAttention();
    Company company2 = <b><FONT COLOR="#000080">new</FONT></b> Company(<b><FONT COLOR="#E1691A">"Cretesoft2"</FONT></b>, <FONT COLOR="#0000ff">20000.0</FONT>,
        ProxyGenerator.make(MoralFibre.<b><FONT COLOR="#000080">class</FONT></b>,
            MoralFibreImpl.<b><FONT COLOR="#000080">class</FONT></b>,
            Concurrency.NONE));
    company2.makeMoney();
    company2.makeMoney();
    company2.makeMoney();
    company2.damageEnvironment();
    company2.becomeFocusOfMediaAttention();
  }
}    
  </pre>

<p>
   When we run this, we see how the moral fibre is constructed
   lazily for the second company:
   </p>

<pre>
<b><i>Moral Fibre Created!</i></b>
Company constructed: Cretesoft has $ 10000.00
Company.makeMoney(): Cretesoft has $ 1010000.00
Company.damageEnvironment(): Cretesoft has $ 5010000.00
Look how good we are... Cretesoft has $ 4110000.00
Company constructed: Cretesoft2 has $ 20000.00
Company.makeMoney(): Cretesoft2 has $ 1020000.00
Company.makeMoney(): Cretesoft2 has $ 2020000.00
Company.makeMoney(): Cretesoft2 has $ 3020000.00
Company.damageEnvironment(): Cretesoft2 has $ 7020000.00
<b><i>Moral Fibre Created!</i></b>
Look how good we are... Cretesoft2 has $ 6120000.00
  </pre>

<p>
   The ProxyGenerator can create virtual proxies of both classes
   and interfaces.  With the dynamic proxy, you can only create
   proxies of interfaces.
   </p>

<p>
   One more thing that is interesting to point out.  When we
   generate the proxy code, the ProxyGenerator makes up a name
   that is likely to be unique.  You can see the different class
   names when you run the following test code:
   </p>

<pre>
<b><FONT COLOR="#000080">import</FONT></b> eu.javaspecialists.tjsn.util.proxy.*;

<b><FONT COLOR="#000080">import</FONT></b> javax.swing.*;
<b><FONT COLOR="#000080">import</FONT></b> javax.swing.table.*;
<b><FONT COLOR="#000080">import</FONT></b> java.util.concurrent.*;

<b><FONT COLOR="#000080">public class</FONT></b> <a href="https://github.com/kabutz/javaspecialists/blob/master/src/main/java/eu/javaspecialists/tjsn/examples/issue181/ProxyGeneratorTest.java">ProxyGeneratorTest</a> {
  <b><FONT COLOR="#000080">public static void</FONT></b> main(String[] args) {
    <b><FONT COLOR="#000080">for</FONT></b> (Concurrency type : Concurrency.values()) {
      test(type);
    }
  }

  <b><FONT COLOR="#000080">private static void</FONT></b> test(Concurrency concurrency) {
    System.out.println();
    System.out.println(<b><FONT COLOR="#E1691A">"Concurrency: "</FONT></b> + concurrency);
    MoralFibre mf = ProxyGenerator.make(MoralFibre.<b><FONT COLOR="#000080">class</FONT></b>,
        MoralFibreImpl.<b><FONT COLOR="#000080">class</FONT></b>, concurrency);
    System.out.println(<b><FONT COLOR="#E1691A">"Moral Fibre: "</FONT></b> + mf.getClass());
    System.out.println(mf);
    mf.actSociallyResponsibly();

    System.out.println();

    ConcurrentMap&lt;String, Integer&gt; map =
        ProxyGenerator.make(ConcurrentMap.<b><FONT COLOR="#000080">class</FONT></b>,
            ConcurrentHashMap.<b><FONT COLOR="#000080">class</FONT></b>, concurrency);

    System.out.println(map.getClass());
    map.put(<b><FONT COLOR="#E1691A">"Hello"</FONT></b>, <FONT COLOR="#0000ff">23</FONT>);
    map.put(<b><FONT COLOR="#E1691A">"Hello2"</FONT></b>, <FONT COLOR="#0000ff">24</FONT>);
    map.put(<b><FONT COLOR="#E1691A">"Hello3"</FONT></b>, <FONT COLOR="#0000ff">25</FONT>);
    System.out.println(map);

    System.out.println();

    AbstractTableModel model =
        ProxyGenerator.make(AbstractTableModel.<b><FONT COLOR="#000080">class</FONT></b>,
            DefaultTableModel.<b><FONT COLOR="#000080">class</FONT></b>, concurrency);
    System.out.println(model.getClass());
    JTable table = new JTable(model);

    System.out.println();

  }
}
  </pre>

<p>
   This ProxyGenerator can make virtual proxies dynamically,
   without the runtime overhead of dynamic proxies.  In
   addition, because this is generated code, can also extend
   classes, which is not possible with dynamic proxies.
   </p>

<p>
   A word of caution about generated code.  I prefer to hide
   this from the developer, although he could of course view it
   for debugging purposes.  It is just too tempting to add a
   little patch here and there.  Before too long, your code will
   be one-way code.
   </p>

<p>
   Kind regards from DÃ¼sseldorf
   </p>

<p>
   Heinz
   </p>



    <div class="clear">&nbsp;</div><hr class="alt1">

    <h3 id="comments">Comments</h3>

    <p>
      We are always happy to receive comments from our readers.
      Feel free to
      <a href="mailto:heinz@javaspecialists.eu?subject=[JavaSpecialists] Issue 181 Comment">send
        me a comment via email</a> or discuss the newsletter in
      our  <a href="https://javaspecialists.slack.com/messages/newsletter">JavaSpecialists
      Slack Channel</a> (<a href="/slack/">Get an invite here</a>)
    </p>

    


<button id="loadDisqus">Load Disqus comments</button>
<div id="disqusInformation">When you load these comments, you'll
    be connected to Disqus.
    <a href="https://help.disqus.com/en/articles/1717103-disqus-privacy-policy">Privacy Statement.</a></div>
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = "https://www.javaspecialists.eu/archive/Issue181.html";
        this.page.identifier = "Newsletter 181";
    };
    !function () {
        function e() {
            t = !0;
            var e = document.createElement("script");
            e.type = "text/javascript", e.async = !0, e.src = "https://javaspecialists.disqus.com/embed.js",
                (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(e)
        }

        var t = !1, s = document.getElementById("loadDisqus");
        s.onclick = function (t) {
            s.outerHTML = "", document.getElementById("disqusInformation").outerHTML = "", e()
        }
    }();
</script>
<noscript>Please enable JavaScript to view the <a
        href="https://disqus.com/?ref_noscript">comments powered
    by Disqus.</a></noscript>

    <h3>Related Articles</h3>

    




<!-------- SHOWCASE NEWSLETTER ---------->



<div class="newsletter">
    <ul class="news-list">

        

        <li>
            <h5>
                <span class="issue">278</span>
                <a href="/archive/Issue278-Free-Memory.html">Free Memory </a>
                <span>2020-04-30</span>
            </h5>
            <p>
                How much memory was wasted when an additional boolean field was added to java.lang.String in Java 13? None at all. This article explains why. <a href="/archive/Issue278-Free-Memory.html">Full Article</a>
            </p>
            <h5></h5>
        </li>
        

        <li>
            <h5>
                <span class="issue">285</span>
                <a href="/archive/Issue285-I-O-Stream-Memory-Overhead.html">I/O Stream Memory Overhead </a>
                <span>2020-10-30</span>
            </h5>
            <p>
                Each PrintStream uses about 25kb of memory. This might seem reasonable if we only have System.out and System.err. But what happens if we try create millions? And why do they use so much memory? <a href="/archive/Issue285-I-O-Stream-Memory-Overhead.html">Full Article</a>
            </p>
            <h5></h5>
        </li>
        

        <li>
            <h5>
                <span class="issue">179</span>
                <a href="/archive/Issue179-Escape-Analysis.html">Escape Analysis </a>
                <span>2009-12-30</span>
            </h5>
            <p>
                Escape analysis can make your code run 110 times faster - if you are a really really bad programmer to begin with :-) In this newsletter we look at some of the places where escape analysis can potentially help us. <a href="/archive/Issue179-Escape-Analysis.html">Full Article</a>
            </p>
            <h5></h5>
        </li>
        
    </ul>
</div>


    <h3> Browse the Newsletter Archive</h3>



<!-------- SHOWCASE NEWSLETTER ---------->



<div class="news-search">
    <form method="get" action="https://www.google.com/search">
        <input type="hidden" name="sitesearch" value="javaspecialists.eu/archive" />
        <input type="text" name="q" class="col_9" placeholder="Search Newsletters" />
        <button class="large green"><i class="fa fa-search"></i> Search</button>
        <p><i>Note: Your search query will be forwarded to Google.</i></p>
    </form>
    <hr class="alt1">

    <p><strong>Categories:</strong>
        
        <a href="/archive/Book Review.html"><button class="small grey">Book Review</button></a>
        
        <a href="/archive/Concurrency.html"><button class="small grey">Concurrency</button></a>
        
        <a href="/archive/Exceptions.html"><button class="small grey">Exceptions</button></a>
        
        <a href="/archive/GUI.html"><button class="small grey">GUI</button></a>
        
        <a href="/archive/Inspirational.html"><button class="small grey">Inspirational</button></a>
        
        <a href="/archive/Language.html"><button class="small grey">Language</button></a>
        
        <a href="/archive/Performance.html"><button class="small grey">Performance</button></a>
        
        <a href="/archive/Software Engineering.html"><button class="small grey">Software Engineering</button></a>
        
        <a href="/archive/Tips and Tricks.html"><button class="small grey">Tips and Tricks</button></a>
        
    </p>
</div>


  </div><!-- ===================== END OF MAIN CONTENT ================== -->


  <!-- SIDEBAR -->
  <div class="col_3">
    
<!-- SIDEBAR -->
<div class="sidebar-signup">
    <h4><i class="fa fa-arrow-down"></i> Subscribe Now </h4>
    <p>
        Get: every new article, exclusive invites to live webinars, our top-10 articles ever, access to expert tutorials &amp; more!
    </p>
    <form class="vertical" accept-charset="UTF-8" action="https://iw127.infusionsoft.com/app/form/process/aaa05d9e465870e9a4e148cd1724545c" method="POST" name="Sign up">
        <input name="inf_form_xid" type="hidden" value="aaa05d9e465870e9a4e148cd1724545c" />
        <input name="inf_form_name" type="hidden" value="Sign up" />
        <input name="infusionsoft_version" type="hidden" value="1.28.7.21" />

        <input type="text" name="inf_field_FirstName" class="col_3"  placeholder="First Name *" />
        <input type="text" name="inf_field_LastName" class="col_3"  placeholder="Last Name" />
        <input type="text" name="inf_field_Company" class="col_3"  placeholder="Company" />
        <input type="text" name="inf_field_Email" class="col_3" placeholder="Email *"/>
        <select name="inf_field_Country" class="col_3"><option value="">Country</option><option value="Afghanistan Honeypot">Afghanistan</option><option value="&Aring;land Islands Honeypot">&Aring;land Islands</option><option value="Albania">Albania</option><option value="Algeria">Algeria</option><option value="American Samoa">American Samoa</option><option value="Andorra">Andorra</option><option value="Angola">Angola</option><option value="Anguilla">Anguilla</option><option value="Antarctica">Antarctica</option><option value="Antigua and Barbuda">Antigua and Barbuda</option><option value="Argentina">Argentina</option><option value="Armenia">Armenia</option><option value="Aruba">Aruba</option><option value="Australia">Australia</option><option value="Austria">Austria</option><option value="Azerbaijan">Azerbaijan</option><option value="Bahamas (the)">Bahamas</option><option value="Bahrain">Bahrain</option><option value="Bangladesh">Bangladesh</option><option value="Barbados">Barbados</option><option value="Belarus">Belarus</option><option value="Belgium">Belgium</option><option value="Belize">Belize</option><option value="Benin">Benin</option><option value="Bermuda">Bermuda</option><option value="Bhutan">Bhutan</option><option value="Bolivia (Plurinational State of)">Bolivia (Plurinational State of)</option><option value="Bonaire, Sint Eustatius and Saba">Bonaire, Sint Eustatius and Saba</option><option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option><option value="Botswana">Botswana</option><option value="Bouvet Island">Bouvet Island</option><option value="Brazil">Brazil</option><option value="British Indian Ocean Territory (the)">British Indian Ocean Territory</option><option value="Brunei Darussalam">Brunei Darussalam</option><option value="Bulgaria">Bulgaria</option><option value="Burkina Faso">Burkina Faso</option><option value="Burundi">Burundi</option><option value="Cabo Verde">Cabo Verde</option><option value="Cambodia">Cambodia</option><option value="Cameroon">Cameroon</option><option value="Canada">Canada</option><option value="Cayman Islands (the)">Cayman Islands</option><option value="Central African Republic (the)">Central African Republic</option><option value="Chad">Chad</option><option value="Chile">Chile</option><option value="China">China</option><option value="Christmas Island">Christmas Island</option><option value="Cocos (Keeling) Islands (the)">Cocos (Keeling) Islands</option><option value="Colombia">Colombia</option><option value="Comoros (the)">Comoros</option><option value="Congo (the Democratic Republic of the)">Congo (Democratic Republic of the)</option><option value="Congo (the)">Congo</option><option value="Cook Islands (the)">Cook Islands</option><option value="Costa Rica">Costa Rica</option><option value="C&ocirc;te D'Ivoire">C&ocirc;te D'Ivoire</option><option value="Croatia">Croatia</option><option value="Cuba">Cuba</option><option value="CuraÃ§ao">CuraÃ§ao</option><option value="Cyprus">Cyprus</option><option value="Czech Republic (the)">Czech Republic</option><option value="Denmark">Denmark</option><option value="Djibouti">Djibouti</option><option value="Dominica">Dominica</option><option value="Dominican Republic (the)">Dominican Republic</option><option value="Ecuador">Ecuador</option><option value="Egypt">Egypt</option><option value="El Salvador">El Salvador</option><option value="Equatorial Guinea">Equatorial Guinea</option><option value="Eritrea">Eritrea</option><option value="Estonia">Estonia</option><option value="Swaziland">Eswatini</option><option value="Ethiopia">Ethiopia</option><option value="Falkland Islands (the) [Malvinas]">Falkland Islands (Malvinas)</option><option value="Faroe Islands (the)">Faroe Islands</option><option value="Fiji">Fiji</option><option value="Finland">Finland</option><option value="France">France</option><option value="French Guiana">French Guiana</option><option value="French Polynesia">French Polynesia</option><option value="French Southern Territories (the)">French Southern Territories</option><option value="Gabon">Gabon</option><option value="Gambia (the)">Gambia</option><option value="Georgia">Georgia</option><option value="Germany">Germany</option><option value="Ghana">Ghana</option><option value="Gibraltar">Gibraltar</option><option value="Greece">Greece</option><option value="Greenland">Greenland</option><option value="Grenada">Grenada</option><option value="Guadeloupe">Guadeloupe</option><option value="Guam">Guam</option><option value="Guatemala">Guatemala</option><option value="Guernsey">Guernsey</option><option value="Guinea">Guinea</option><option value="Guinea-Bissau">Guinea-Bissau</option><option value="Guyana">Guyana</option><option value="Haiti">Haiti</option><option value="Heard Island and McDonald Islands">Heard Island and McDonald Islands</option><option value="Holy See (the)">Holy See</option><option value="Honduras">Honduras</option><option value="Hong Kong">Hong Kong</option><option value="Hungary">Hungary</option><option value="Iceland">Iceland</option><option value="India">India</option><option value="Indonesia">Indonesia</option><option value="Iran (Islamic Republic of)">Iran (Islamic Republic of)</option><option value="Iraq">Iraq</option><option value="Ireland">Ireland</option><option value="Isle of Man">Isle of Man</option><option value="Israel">Israel</option><option value="Italy">Italy</option><option value="Jamaica">Jamaica</option><option value="Japan">Japan</option><option value="Jersey">Jersey</option><option value="Johnston Island">Johnston Island</option><option value="Jordan">Jordan</option><option value="Kazakhstan">Kazakhstan</option><option value="Kenya">Kenya</option><option value="Kiribati">Kiribati</option><option value="Korea (the Democratic People's Republic of)">Korea (North)</option><option value="Korea (the Republic of)">Korea (South)</option><option value="Kuwait">Kuwait</option><option value="Kyrgyzstan">Kyrgyzstan</option><option value="Lao People's Democratic Republic (the)">Lao People's Democratic Republic</option><option value="Latvia">Latvia</option><option value="SPAMMER Honeypot">SPAMMER Honeypot</option><option value="SPAMMER Honeypot">SPAMMER Honeypot</option><option value="Lebanon">Lebanon</option><option value="Lesotho">Lesotho</option><option value="Liberia">Liberia</option><option value="Libya">Libya</option><option value="Liechtenstein">Liechtenstein</option><option value="Lithuania">Lithuania</option><option value="Luxembourg">Luxembourg</option><option value="Macao">Macao</option><option value="Madagascar">Madagascar</option><option value="Malawi">Malawi</option><option value="Malaysia">Malaysia</option><option value="Maldives">Maldives</option><option value="Mali">Mali</option><option value="Malta">Malta</option><option value="Marshall Islands (the)">Marshall Islands</option><option value="Martinique">Martinique</option><option value="Mauritania">Mauritania</option><option value="Mauritius">Mauritius</option><option value="Mayotte">Mayotte</option><option value="Mexico">Mexico</option><option value="Micronesia (Federated States of)">Micronesia (Federated States of)</option><option value="Midway Islands">Midway Islands</option><option value="Moldova (the Republic of)">Moldova (Republic of)</option><option value="Monaco">Monaco</option><option value="Mongolia">Mongolia</option><option value="Montenegro">Montenegro</option><option value="Montserrat">Montserrat</option><option value="Morocco">Morocco</option><option value="Mozambique">Mozambique</option><option value="Myanmar">Myanmar</option><option value="Namibia">Namibia</option><option value="Nauru">Nauru</option><option value="Nepal">Nepal</option><option value="Netherlands (the)">Netherlands</option><option value="New Caledonia">New Caledonia</option><option value="New Zealand">New Zealand</option><option value="Nicaragua">Nicaragua</option><option value="Niger (the)">Niger</option><option value="Nigeria">Nigeria</option><option value="Niue">Niue</option><option value="Norfolk Island">Norfolk Island</option><option value="Macedonia (the former Yugoslav Republic of)">North Macedonia</option><option value="Northern Mariana Islands (the)">Northern Mariana Islands</option><option value="Norway">Norway</option><option value="Oman">Oman</option><option value="Pakistan">Pakistan</option><option value="Palau">Palau</option><option value="Palestine, State of">Palestine, State of</option><option value="Panama">Panama</option><option value="Papua New Guinea">Papua New Guinea</option><option value="Paraguay">Paraguay</option><option value="Peru">Peru</option><option value="Philippines (the)">Philippines</option><option value="Pitcairn">Pitcairn</option><option value="Poland">Poland</option><option value="Portugal">Portugal</option><option value="Puerto Rico">Puerto Rico</option><option value="Qatar">Qatar</option><option value="R&eacute;union">R&eacute;union</option><option value="Romania">Romania</option><option value="Russian Federation (the)">Russian Federation</option><option value="Rwanda">Rwanda</option><option value="Saint Barth&eacute;lemy">Saint Barth&eacute;lemy</option><option value="Saint Helena, Ascension and Tristan Da Cunha">Saint Helena, Ascension and Tristan Da Cunha</option><option value="Saint Kitts And Nevis">Saint Kitts And Nevis</option><option value="Saint Lucia">Saint Lucia</option><option value="Saint Martin (French part)">Saint Martin (French part)</option><option value="Saint Pierre And Miquelon">Saint Pierre And Miquelon</option><option value="Saint Vincent And The Grenadines">Saint Vincent And The Grenadines</option><option value="Samoa">Samoa</option><option value="San Marino">San Marino</option><option value="Sao Tome and Principe">Sao Tome and Principe</option><option value="Saudi Arabia">Saudi Arabia</option><option value="Senegal">Senegal</option><option value="Serbia">Serbia</option><option value="Seychelles">Seychelles</option><option value="Sierra Leone">Sierra Leone</option><option value="Singapore">Singapore</option><option value="Sint Maarten (Dutch part)">Sint Maarten (Dutch part)</option><option value="Slovakia">Slovakia</option><option value="Slovenia">Slovenia</option><option value="Solomon Islands">Solomon Islands</option><option value="Somalia">Somalia</option><option value="South Africa">South Africa</option><option value="South Georgia and the South Sandwich Islands">South Georgia and the South Sandwich Islands</option><option value="South Sudan">South Sudan</option><option value="Spain">Spain</option><option value="Sri Lanka">Sri Lanka</option><option value="Sudan (the)">Sudan</option><option value="Suriname">Suriname</option><option value="Svalbard and Jan Mayen">Svalbard and Jan Mayen</option><option value="Sweden">Sweden</option><option value="Switzerland">Switzerland</option><option value="Syrian Arab Republic">Syrian Arab Republic</option><option value="Taiwan (Province of China)">Taiwan</option><option value="Tajikistan">Tajikistan</option><option value="Tanzania, United Republic of">Tanzania, United Republic of</option><option value="Thailand">Thailand</option><option value="Timor-Leste">Timor-Leste</option><option value="Togo">Togo</option><option value="Tokelau">Tokelau</option><option value="Tonga">Tonga</option><option value="Trinidad and Tobago">Trinidad and Tobago</option><option value="Tunisia">Tunisia</option><option value="Turkey">Turkey</option><option value="Turkmenistan">Turkmenistan</option><option value="Turks and Caicos Islands (the)">Turks and Caicos Islands</option><option value="Tuvalu">Tuvalu</option><option value="Uganda">Uganda</option><option value="Ukraine">Ukraine</option><option value="United Arab Emirates (the)">United Arab Emirates</option><option value="United Kingdom">United Kingdom</option><option value="United States">United States of America</option><option value="United States Minor Outlying Islands (the)">United States Minor Outlying Islands</option><option value="Uruguay">Uruguay</option><option value="Uzbekistan">Uzbekistan</option><option value="Vanuatu">Vanuatu</option><option value="Venezuela (Bolivarian Republic of)">Venezuela (Bolivarian Republic of)</option><option value="Viet Nam">Viet Nam</option><option value="Virgin Islands (British)">Virgin Islands (British)</option><option value="Virgin Islands (U.S.)">Virgin Islands (U.S.)</option><option value="Wallis and Futuna">Wallis and Futuna</option><option value="Western Sahara">Western Sahara</option><option value="Yemen">Yemen</option><option value="Zambia Honeypot">Zambia</option><option value="Zimbabwe Honeypot">Zimbabwe</option></select>
        <select name="inf_custom_Skill" class="col_3"><option value="">Java Skill Level *</option><option value="Beginner">Beginner</option><option value="Intermediate">Intermediate</option><option value="Advanced">Advanced</option><option value="Guru">Guru</option></select>
        <label><input id="inf_option_AgreetoJavaSpecialistsPrivacyPolicy" name="inf_option_AgreetoJavaSpecialistsPrivacyPolicy" type="checkbox" value="2632" />Agree to JavaSpecialists Privacy Policy *</label>
        <button type="submit" class="button orange medium"><i class="fa fa-check"></i> Subscribe</button>
        <p>Read our <a href="/about/privacy/">Privacy Policy</a></p>
    </form>
</div>
    

<div class="about-the-author">
    <h4>About the Author</h4>
    <img src="/skin/skin4/images/heinz-devoxx-slim-blue.jpg" alt="Heinz Kabutz Java Conference Speaker">
    <p>Java Champion, author of the Javaspecialists Newsletter, conference speaking regular...
        <a href="/about/heinz/">About Heinz</a></p>

        <h4>Superpack '22</h4>
    <a href="https://javaspecialists.teachable.com/p/superpack22"><img src="/pics/teachable/superpack-thumbnail-ios.png" alt="Superpack '22" width="300" height="300"/></a>
    Our entire Java Specialists Training in one huge bundle
    <a href="https://javaspecialists.teachable.com/p/superpack22">more...</a>


    <h4>Free Java Course</h4>

<center>
    <a href="/courses/juppies2"> <img src="/pics/teachable/juppies2-ios.png" alt="Free Juppies 2 Course"
                                      width="150" height="150"/></a> <br/>
    Juppies 2 - a course for complete beginners
    <a href="/courses/juppies2">more...</a>
</center>

    <h4>Free Java Book</h4>

<center>
    <a href="https://www.infoq.com/minibooks/java-dynamic-proxies/"><img src="/pics/dynamic-proxies-in-java.jpg" alt="Dynamic Proxies in Java Book"
                                                                         width="154" height="200"/></a>
</center>


    
</div>



  </div>
</div>

<!-------- SERVICES BOXOUTS ---------->

<div class="col_4 boxed services">
    <i class="fa fa-users fa-3x pull-left"></i>
    <h5>Java Training</h5>
    <p>We deliver relevant courses, by top Java developers to produce more
        resourceful and efficient programmers within their organisations.</p>
    <p class="right"><a href="/courses/"><button class="medium grey">Java Training</button></a></p>
</div>
<div class="col_4 boxed services">
    <i class="fa fa-comments fa-3x pull-left"></i>
    <h5>Java Consulting</h5>
    <p>
        We can help make your Java application run faster and
        trouble-shoot concurrency and performance bugs...</p>
    <p class="right"><a href="/services/performance-consulting/"><button class="medium grey">Java Consulting</button></a></p>
</div>
<div class="col_4 boxed services">
    <i class="fa fa-plus fa-3x pull-left"></i>
    <h5>Java Emergency?</h5>
    <p>
        If your system is down, we will review it for 15 minutes
        and give you our findings for just 1 &euro; without any
        obligation.
    </p>
    <p class="right"><a href="/services/emergency-consulting/"><button class="medium red">Get Help Now</button></a></p>
</div>

<!-------- PREFOOTER  ---------->

<div class="clear"></div>

<div id="pre-footer">
    <div class="col_12">
        <div class="col_3">
            <h5>JavaSpecialists</h5>
            <p>We deliver relevant courses, by top Java developers to produce more resourceful and efficient
                programmers within their organisations. <a href="/courses/">Find Out More </a></p>
        </div>
        <div class="col_3">
            <h5>Quick Links</h5>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/archive/">The Newsletter</a></li>
                <li><a href="/courses/">Java Training</a></li>
                <li><a href="/about/">About Us</a></li>
                <li><a href="/services/performance-consulting/">Java Consulting</a></li>

            </ul>
        </div>
        <div class="col_6">
            <h5>Connect With Us</h5>
            <ul class="alt">
                <li><i class="fa fa-whatsapp fa-2x"></i> WhatsApp: <a href="https://api.whatsapp.com/send?phone=306975595262&text=I+was+on+your+website+and+need+further+assistance">Kabutz</a></li>
                <li><i class="fa fa-envelope fa-2x"></i> <a href="mailto:heinz@javaspecialists.eu?subject=Enquiry about JavaSpecialists">heinz@javaspecialists.eu</a></li>
                <li><i class="fa fa-twitter fa-2x"></i>  <a href="https://twitter.com/heinzkabutz" target="_blank">@HeinzKabutz</a></li>
                <li><i class="fa fa-pencil-square-o fa-2x"></i> <a href="/contact/">Contact Us Page</a></li>
            </ul>
        </div>
    </div>
</div>


</div>






<!-- ===================================== START FOOTER ===================================== -->
<div class="clear"></div>

<div id="footer">
  Copyright &copy; 2000-2022 Dr Heinz Kabutz - All Rights Reserved.
  &bull;  All Rights Reserved. &bull;  <a href="https://www.catch22marketing.com">Website design and build</a>
  Catch22 Marketing &bull; <a href="/sitemap/">Sitemap</a> <br>
  Oracle and Java are registered trademarks of Oracle and/or its affiliates. Other names may be trademarks of their respective owners. JavaSpecialists.eu is not connected to Oracle, Inc. and is not sponsored by Oracle, Inc.
</div>

</div><!-- END GRID-->


    <!-- rendered in 1 ms -->


</body>
</html>


